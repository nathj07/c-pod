# Apache configuration fragment for the C-Pod server
#
<Directory "<%= node[:cpod][:base] %>/">
    AllowOverride None
    <% if node['apache']['version'] != "2.4" -%>
    Order deny,allow
    Deny from all
    <% else -%>
    Require all denied
    <% end -%>
</Directory>

<Directory "<%= node[:cpod][:base] %>/c-pod/www">
    Options Includes Indexes FollowSymLinks
    IndexIgnore .htaccess *.bak *~ RCS
    IndexOptions FancyIndexing FoldersFirst
    AllowOverride None
    <% if node['apache']['version'] != "2.4" -%>
    Order allow,deny
    Allow from all
    <% else -%>
    Require all granted
    <% end -%>
</Directory>

<Directory "<%= node[:cpod][:base] %>/c-pod/bin/">
    Options +ExecCGI
    SetHandler cgi-script
    AllowOverride None
    <% if node['apache']['version'] != "2.4" -%>
    Order allow,deny
    Allow from all
    <% else -%>
    Require all granted
    <% end -%>
</Directory>

ServerName <%= node[:cpod][:server_name] %>

<VirtualHost *:80>

    ScriptAlias /bin "<%= node[:cpod][:base] %>/c-pod/bin"

    IndexIgnore .htaccess *.bak *~ RCS
    DocumentRoot <%= node[:cpod][:base] %>/c-pod/www
    ErrorLog <%= node['apache']['log_dir'] %>/c-pod_error_log
    CustomLog <%= node['apache']['log_dir'] %>/c-pod_access_log combined
    AddType text/plain .ks .seed
    AddType application/x-ns-proxy-autoconfig .pac
    AddHandler server-parsed .ks .seed .html .pac
    <Location /samples/>
	ForceType text/plain
	SetHandler server-parsed
    </Location>
    Action markdown /bin/markdown.cgi
    AddHandler markdown .md

</VirtualHost>

# vim: sts=4 sw=4 ts=8:
